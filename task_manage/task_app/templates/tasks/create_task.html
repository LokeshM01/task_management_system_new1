{% extends "base_generic.html" %}

{% block content %}
<h2>Create a Task</h2>
<hr>

<div class="form-container">
    <form method="post" enctype="multipart/form-data" id="createTaskForm">
        {% csrf_token %}

        <!-- Assigned By (Disabled) -->
        <div class="form-group">
            <label for="assigned_by">Assigned by:</label>
            <select id="assigned_by" name="assigned_by" disabled>
                <option selected>{{ request.user.username }}</option>
            </select>
        </div>

        <!-- Ticket Type -->
        <div class="form-group">
            <label for="ticket_type">Ticket Type:</label>
            <select id="ticket_type" name="ticket_type">
                <option value="Bug Fixing - Live">Bug Fixing - Live</option>
                <option value="Bug Fixing - Staging">Bug Fixing - Staging</option>
                <option value="Hardware">Hardware</option>
                <option value="Issues">Issues</option>
                <option value="New Engineering Requirement">New Engineering Requirement</option>
                <option value="Publishing">Publishing</option>
                <option value="Research">Research</option>
                <option value="Attendance">Attendance</option>
                <option value="Sales">Sales</option>
                <option value="Service">Service</option>
                <option value="Testing">Testing</option>
                <option value="Others">Others</option>
            </select>
        </div>

        <!-- Priority -->
        <div class="form-group">
            <label for="priority">Priority:</label>
            <select id="priority" name="priority">
                <option value="High Priority">High Priority</option>
                <option value="Low Priority">Low Priority</option>
                <option value="Medium Priority">Medium Priority</option>
                <option value="Urgent">Urgent</option>
            </select>
        </div>

        <!-- Department -->
        <div class="form-group">
            <label for="department">Department:</label>
            <select id="department" name="department">
                <option value="Engineering Team">Engineering Team</option>
                <option value="Product Team">Product Team</option>
                <option value="Sales Team">Sales Team</option>
                <option value="Content Team">Content Team</option>
                <option value="Customer Support">Customer Support</option>
                <option value="HR">HR</option>
                <option value="Non Management Staff">Non Management Staff</option>
                <option value="Publishing Team">Publishing Team</option>
                <option value="Help Desk">Help Desk</option>
                <option value="Executive Managers">Executive Managers</option>
            </select>
        </div>

        <!-- Assigned To -->
        <div class="form-group">
            <label for="assigned_to">Assigned to:</label>
            <select id="assigned_to" name="assigned_to">
                {% for user in users %}
                    <option value="{{ user.id }}">{{ user.username }}</option>
                {% endfor %}
            </select>
        </div>

        <!-- Deadline -->
        <div class="form-group">
            <label for="deadline">Deadline:</label>
            <input type="date" id="deadline" name="deadline">
        </div>

        <!-- Subject -->
        <div class="form-group full-width">
            <label for="subject">Subject:</label>
            <input type="text" id="subject" name="subject" required>
        </div>

        <!-- Request Details (Rich Text Editor) -->
        <div class="form-group full-width">
            <label for="request_details">Request details:</label>
            <textarea id="request_details" name="request_details" rows="4"></textarea>
        </div>

        <!-- Attach File -->
        <div class="form-group">
            <label for="attach_file">Attach File:</label>
            <input type="file" id="attach_file" name="attach_file" accept=".pdf,.ppt,.pptx,.doc,.docx,.mp4,.jpg,.png,.jpeg">
        </div>

        <!-- Create Task Button -->
        <button type="submit" class="submit-btn">Create Task</button>
    </form>
</div>

<!-- Success Popup -->
<div id="successPopup" class="popup">
    <div class="popup-content">
        <p>Task created successfully!</p>
        <button onclick="closePopup()">âœ–</button>
    </div>
</div>

<!-- Inline CSS for styling -->
<style>
    .form-container {
        background-color: #ffffff;
        padding: 20px;
        border-radius: 8px;
        max-width: 800px;
        margin: 0 auto;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    h2 {
        text-align: center;
        color: #333;
    }

    hr {
        border: none;
        border-top: 2px solid #4CAF50;
        margin: 10px 0 20px;
    }

    .form-group {
        display: flex;
        flex-direction: column;
        margin-bottom: 15px;
    }

    .form-group label {
        font-weight: bold;
        color: #333;
        margin-bottom: 5px;
    }

    .form-group select, .form-group input[type="text"], 
    .form-group input[type="date"], .form-group textarea, 
    .form-group input[type="file"] {
        padding: 10px;
        font-size: 14px;
        border-radius: 4px;
        border: 1px solid #ccc;
        outline: none;
        width: 100%;
        box-sizing: border-box;
    }

    .submit-btn {
        background-color: #4CAF50;
        color: #ffffff;
        padding: 10px 20px;
        font-size: 16px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        width: 100%;
        margin-top: 20px;
    }

    .submit-btn:hover {
        background-color: #388E3C;
    }

    .popup {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        justify-content: center;
        align-items: center;
    }

    .popup-content {
        background-color: #fff;
        padding: 20px;
        border-radius: 8px;
        text-align: center;
        position: relative;
    }

    .popup-content button {
        position: absolute;
        top: 10px;
        right: 10px;
        background: none;
        border: none;
        font-size: 18px;
        cursor: pointer;
    }
</style>

<!-- Inline JavaScript for Popup and Form Submission -->
<script>
    document.getElementById('createTaskForm').onsubmit = function(event) {
        event.preventDefault();
        showPopup();
    };

    function showPopup() {
        document.getElementById('successPopup').style.display = 'flex';
    }

    function closePopup() {
        document.getElementById('successPopup').style.display = 'none';
    }
</script>

{% endblock %}
